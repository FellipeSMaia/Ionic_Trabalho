<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      {{ isEdicao ? "Editar Dados do Cliente" : "Cadastro de Cliente" }}
    </ion-title>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="custom-content">
  <div *ngIf="carregando" class="loading-container">
    <ion-spinner name="circular"></ion-spinner>
    <ion-text>
      <p>Carregando...</p>
    </ion-text>
  </div>

  <form
    [formGroup]="clienteForm"
    (ngSubmit)="onSubmit()"
    *ngIf="!carregando"
    class="custom-form"
  >
    <div class="form-section">
      <div class="section-header">
        <h2>Dados Pessoais</h2>
        <div class="divider"></div>
      </div>

      <div class="form-group">
        <ion-item class="custom-item">
          <ion-label position="stacked">Nome Completo</ion-label>
          <ion-input
            type="text"
            formControlName="nome"
            placeholder="Digite o nome completo"
            [class.ion-invalid]="isFieldInvalid('nome')"
            [class.ion-touched]="clienteForm.get('nome')?.touched"
          ></ion-input>
        </ion-item>
        <ion-text
          color="danger"
          *ngIf="isFieldInvalid('nome')"
          class="error-text"
        >
          <small>{{ getErrorMessage("nome") }}</small>
        </ion-text>

        <ion-item class="custom-item">
          <ion-label position="stacked">Telefone</ion-label>
          <ion-input
            type="tel"
            formControlName="telefone"
            placeholder="(00) 00000-0000"
            maxlength="15"
            (ionInput)="onTelefoneChange($event)"
            [class.ion-invalid]="isFieldInvalid('telefone')"
            [class.ion-touched]="clienteForm.get('telefone')?.touched"
          ></ion-input>
        </ion-item>
        <ion-text
          color="danger"
          *ngIf="isFieldInvalid('telefone')"
          class="error-text"
        >
          <small>{{ getErrorMessage("telefone") }}</small>
        </ion-text>
      </div>
    </div>

    <div class="form-section">
      <div class="section-header">
        <h2>Endereço</h2>
        <div class="divider"></div>
      </div>

      <div class="form-group">
        <ion-row>
          <ion-col size="6">
            <ion-item class="custom-item">
              <ion-label position="stacked">CEP</ion-label>
              <ion-input
                type="text"
                formControlName="cep"
                placeholder="00000-000"
                maxlength="9"
                (ionInput)="onCepChange($event)"
                [class.ion-invalid]="isFieldInvalid('cep')"
                [class.ion-touched]="clienteForm.get('cep')?.touched"
              ></ion-input>
            </ion-item>
            <ion-text
              color="danger"
              *ngIf="isFieldInvalid('cep')"
              class="error-text"
            >
              <small>{{ getErrorMessage("cep") }}</small>
            </ion-text>
          </ion-col>

          <ion-col size="6">
            <ion-item class="custom-item">
              <ion-label position="stacked">Estado</ion-label>
              <ion-select
                formControlName="estado"
                placeholder="Selecione"
                [class.ion-invalid]="isFieldInvalid('estado')"
                [class.ion-touched]="clienteForm.get('estado')?.touched"
              >
                <ion-select-option value="AC">Acre</ion-select-option>
                <ion-select-option value="AL">Alagoas</ion-select-option>
                <ion-select-option value="AP">Amapá</ion-select-option>
                <ion-select-option value="AM">Amazonas</ion-select-option>
                <ion-select-option value="BA">Bahia</ion-select-option>
                <ion-select-option value="CE">Ceará</ion-select-option>
                <ion-select-option value="DF"
                  >Distrito Federal</ion-select-option
                >
                <ion-select-option value="ES">Espírito Santo</ion-select-option>
                <ion-select-option value="GO">Goiás</ion-select-option>
                <ion-select-option value="MA">Maranhão</ion-select-option>
                <ion-select-option value="MT">Mato Grosso</ion-select-option>
                <ion-select-option value="MS"
                  >Mato Grosso do Sul</ion-select-option
                >
                <ion-select-option value="MG">Minas Gerais</ion-select-option>
                <ion-select-option value="PA">Pará</ion-select-option>
                <ion-select-option value="PB">Paraíba</ion-select-option>
                <ion-select-option value="PR">Paraná</ion-select-option>
                <ion-select-option value="PE">Pernambuco</ion-select-option>
                <ion-select-option value="PI">Piauí</ion-select-option>
                <ion-select-option value="RJ">Rio de Janeiro</ion-select-option>
                <ion-select-option value="RN"
                  >Rio Grande do Norte</ion-select-option
                >
                <ion-select-option value="RS"
                  >Rio Grande do Sul</ion-select-option
                >
                <ion-select-option value="RO">Rondônia</ion-select-option>
                <ion-select-option value="RR">Roraima</ion-select-option>
                <ion-select-option value="SC">Santa Catarina</ion-select-option>
                <ion-select-option value="SP">São Paulo</ion-select-option>
                <ion-select-option value="SE">Sergipe</ion-select-option>
                <ion-select-option value="TO">Tocantins</ion-select-option>
              </ion-select>
            </ion-item>
            <ion-text
              color="danger"
              *ngIf="isFieldInvalid('estado')"
              class="error-text"
            >
              <small>{{ getErrorMessage("estado") }}</small>
            </ion-text>
          </ion-col>
        </ion-row>

        <ion-item class="custom-item">
          <ion-label position="stacked">Endereço</ion-label>
          <ion-input
            type="text"
            formControlName="endereco"
            placeholder="Digite o endereço completo"
            [class.ion-invalid]="isFieldInvalid('endereco')"
            [class.ion-touched]="clienteForm.get('endereco')?.touched"
          ></ion-input>
        </ion-item>
        <ion-text
          color="danger"
          *ngIf="isFieldInvalid('endereco')"
          class="error-text"
        >
          <small>{{ getErrorMessage("endereco") }}</small>
        </ion-text>

        <ion-row>
          <ion-col size="6">
            <ion-item class="custom-item">
              <ion-label position="stacked">Bairro</ion-label>
              <ion-input
                type="text"
                formControlName="bairro"
                placeholder="Digite o bairro"
                [class.ion-invalid]="isFieldInvalid('bairro')"
                [class.ion-touched]="clienteForm.get('bairro')?.touched"
              ></ion-input>
            </ion-item>
            <ion-text
              color="danger"
              *ngIf="isFieldInvalid('bairro')"
              class="error-text"
            >
              <small>{{ getErrorMessage("bairro") }}</small>
            </ion-text>
          </ion-col>

          <ion-col size="6">
            <ion-item class="custom-item">
              <ion-label position="stacked">Cidade</ion-label>
              <ion-input
                type="text"
                formControlName="cidade"
                placeholder="Digite a cidade"
                [class.ion-invalid]="isFieldInvalid('cidade')"
                [class.ion-touched]="clienteForm.get('cidade')?.touched"
              ></ion-input>
            </ion-item>
            <ion-text
              color="danger"
              *ngIf="isFieldInvalid('cidade')"
              class="error-text"
            >
              <small>{{ getErrorMessage("cidade") }}</small>
            </ion-text>
          </ion-col>
        </ion-row>
      </div>
    </div>

    <div class="button-container">
      <ion-button
        expand="block"
        fill="outline"
        color="medium"
        (click)="onCancel()"
        class="cancel-button"
      >
        Cancelar
      </ion-button>
      <ion-button
        expand="block"
        type="submit"
        [disabled]="clienteForm.invalid"
        color="primary"
        class="submit-button"
      >
        {{ isEdicao ? "Atualizar Dados" : "Salvar Dados" }}
      </ion-button>
    </div>
  </form>
</ion-content>
